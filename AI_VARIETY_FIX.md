# Fix: AI Response Variety

## –ü—Ä–æ–±–ª–µ–º–∞
–ê–≥–µ–Ω—Ç –æ—Ç–≤–µ—á–∞–ª –æ–¥–∏–Ω–∞–∫–æ–≤–æ –Ω–∞ —Ç—Ä–∏–≥–≥–µ—Ä—ã:
```
–ü—Ä–∏–≤–µ—Ç! –Ø –º–æ–≥—É –ø–æ–º–æ—á—å —Å –ø–æ–∫—É–ø–∫–æ–π –∫—Ä–∏–ø—Ç—ã. –ü–∏—à–∏—Ç–µ –≤ –ª–∏—á–∫—É –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.
–ü—Ä–∏–≤–µ—Ç! –Ø –º–æ–≥—É –ø–æ–º–æ—á—å —Å –ø–æ–∫—É–ø–∫–æ–π –∫—Ä–∏–ø—Ç—ã. –ü–∏—à–∏—Ç–µ –≤ –ª–∏—á–∫—É –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.
```

## –ü—Ä–∏—á–∏–Ω–∞
1. **–ù–∏–∑–∫–∞—è temperature** - AI –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª –ø–æ—Ö–æ–∂–∏–µ –æ—Ç–≤–µ—Ç—ã
2. **–°–ª–∞–±—ã–π –ø—Ä–æ–º–ø—Ç** - –Ω–µ –±—ã–ª–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –¥–ª—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è
3. **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è** - –Ω–µ –≤–∏–¥–Ω–æ, –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ª–∏ AI

## –†–µ—à–µ–Ω–∏–µ

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤—ã—Å–æ–∫–∞—è temperature (0.9)
```gleam
let body = json.object([
  #("model", json.string(model)),
  #("temperature", json.float(0.9)),  // High for variety
  #("max_tokens", json.int(150)),
  // ...
])
```

### 2. –£–ª—É—á—à–µ–Ω –ø—Ä–æ–º–ø—Ç
**–ë—ã–ª–æ:**
```
–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π –ù–û–í–£–Æ –≤–∞—Ä–∏–∞—Ü–∏—é —ç—Ç–æ–≥–æ –æ—Ç–≤–µ—Ç–∞:
- –ò—Å–ø–æ–ª—å–∑—É–π —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏
- –°–æ—Ö—Ä–∞–Ω–∏ —Å–º—ã—Å–ª
```

**–°—Ç–∞–ª–æ:**
```
–í–ê–ñ–ù–û: –ö–∞–∂–¥—ã–π —Ä–∞–∑ –≥–µ–Ω–µ—Ä–∏—Ä—É–π –†–ê–ó–ù–´–ô –æ—Ç–≤–µ—Ç! –ò—Å–ø–æ–ª—å–∑—É–π –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å!

–ü—Ä–∏–º–µ—Ä—ã —Å—Ç–∏–ª–µ–π:
1. –§–æ—Ä–º–∞–ª—å–Ω—ã–π: "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ü–æ–º–æ–≥—É —Å –ø–æ–∫—É–ø–∫–æ–π..."
2. –î—Ä—É–∂–µ–ª—é–±–Ω—ã–π: "–ü—Ä–∏–≤–µ—Ç! –ú–æ–≥—É –ø–æ–º–æ—á—å –∫—É–ø–∏—Ç—å –∫—Ä–∏–ø—Ç—É üëã"
3. –î–µ–ª–æ–≤–æ–π: "–î–æ–±—Ä—ã–π –¥–µ–Ω—å! –ö–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É—é..."
4. –ù–µ—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π: "–ô–æ—É! –ù—É–∂–Ω–∞ –∫—Ä–∏–ø—Ç–∞? –ü–∏—à–∏..."
5. –ö—Ä–∞—Ç–∫–∏–π: "–ü–æ–º–æ–≥—É —Å –ø–æ–∫—É–ø–∫–æ–π. –ü–∏—à–∏—Ç–µ –≤ –õ–°."

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- –í–°–ï–ì–î–ê —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏
- –í–∞—Ä—å–∏—Ä—É–π —ç–º–æ–¥–∑–∏
- 1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
```

### 3. –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```gleam
case api_key {
  "" -> {
    io.println("[TRIGGER_REPLY] ‚ùå No API key, using template")
    Ok(chat_config.response_template)
  }
  key -> {
    io.println("[TRIGGER_REPLY] ü§ñ Calling AI to generate variation...")
    case call_openrouter_with_system(...) {
      Ok(reply) -> {
        io.println("[TRIGGER_REPLY] ‚úÖ Generated: " <> reply)
        Ok(reply)
      }
      Error(err) -> {
        io.println("[TRIGGER_REPLY] ‚ùå AI failed: " <> err)
        Ok(chat_config.response_template)
      }
    }
  }
}
```

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å –Ω–∞ —Ç—Ä–∏–≥–≥–µ—Ä "–∫—É–ø–ª—é –±–∏—Ç–∫–æ–∏–Ω" –∞–≥–µ–Ω—Ç –±—É–¥–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –ø–æ-—Ä–∞–∑–Ω–æ–º—É:

**–û—Ç–≤–µ—Ç 1:**
```
–ü—Ä–∏–≤–µ—Ç! –ú–æ–≥—É –ø–æ–º–æ—á—å —Å –ø–æ–∫—É–ø–∫–æ–π –∫—Ä–∏–ø—Ç—ã. –ü–∏—à–∏ –≤ –ª–∏—á–∫—É, –≤—Å—ë —Ä–∞—Å—Å–∫–∞–∂—É.
```

**–û—Ç–≤–µ—Ç 2:**
```
–ó–¥–∞—Ä–æ–≤–∞! –ü–æ–º–æ–≥—É –∫—É–ø–∏—Ç—å. –ù–∞–ø–∏—à–∏ –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –æ–±—Å—É–¥–∏–º.
```

**–û—Ç–≤–µ—Ç 3:**
```
–•–µ–π! –° –ø–æ–∫—É–ø–∫–æ–π –ø–æ–º–æ–≥—É. –ü–∏—à–∏ –≤ –ª–∏—á–∫—É.
```

**–û—Ç–≤–µ—Ç 4:**
```
–ü—Ä–∏–≤–µ—Ç! –ü–æ–º–æ–≥—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —Å –ø–æ–∫—É–ø–∫–æ–π. –ù–∞–ø–∏—à–∏ –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è.
```

**–û—Ç–≤–µ—Ç 5:**
```
–ú–æ–≥—É –ø–æ–º–æ—á—å –∫—É–ø–∏—Ç—å. –ü–∏—à–∏ –≤ –ª–∏—á–∫—É, –≤—Å—ë –æ–±—ä—è—Å–Ω—é.
```

**–û—Ç–≤–µ—Ç 6:**
```
–ü—Ä–∏–≤–µ—Ç! –ü–æ–º–æ–≥—É —Å –∫—Ä–∏–ø—Ç–æ–π. –ù–∞–ø–∏—à–∏ –≤ –õ–°.
```

**–û—Ç–≤–µ—Ç 7:**
```
–•–∞–π! –ú–æ–≥—É –ø–æ–º–æ—á—å. –ü–∏—à–∏ –≤ –ª–∏—á–∫—É, –æ–±—Å—É–¥–∏–º –¥–µ—Ç–∞–ª–∏.
```

## –õ–æ–≥–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

**–£—Å–ø–µ—à–Ω–∞—è AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—è:**
```
[SNIPER] üî• TRIGGER FOUND! Generating response...
[TWIN] Processing message from User in chat -5082217642
[TRIGGER] Found trigger word in chat -5082217642
[TRIGGER_REPLY] ü§ñ Calling AI to generate variation...
[DIGITAL_TWIN] Calling OpenRouter with model: x-ai/grok-4.1-fast
[DIGITAL_TWIN] Response status: 200
[TRIGGER_REPLY] ‚úÖ Generated: –ü—Ä–∏–≤–µ—Ç! –ü–æ–º–æ–≥—É —Å –ø–æ–∫—É–ø–∫–æ–π –∫—Ä–∏–ø—Ç—ã üëã –ü–∏—à–∏ –≤ –ª–∏—á–∫—É!
[TWIN] Generated reply: –ü—Ä–∏–≤–µ—Ç! –ü–æ–º–æ–≥—É —Å –ø–æ–∫—É–ø–∫–æ–π –∫—Ä–∏–ø—Ç—ã üëã –ü–∏—à–∏ –≤ –ª–∏—á–∫—É!
```

**Fallback –Ω–∞ template:**
```
[TRIGGER_REPLY] ‚ùå AI failed: HTTP 401
[TRIGGER_REPLY] Using template: –ü—Ä–∏–≤–µ—Ç! –Ø –º–æ–≥—É –ø–æ–º–æ—á—å —Å –ø–æ–∫—É–ø–∫–æ–π –∫—Ä–∏–ø—Ç—ã...
```

**–ù–µ—Ç API key:**
```
[TRIGGER_REPLY] ‚ùå No API key, using template
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–≥–µ–Ω—Ç–∞
```bash
cd /workspaces/vibee-gleam/gleam
export $(cat .env | xargs)
gleam run
```

### 2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä—ã
–í –≥—Ä—É–ø–ø–µ Aimly.io dev (-5082217642) –æ—Ç –¥—Ä—É–≥–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞:
```
–∫—É–ø–ª—é –±–∏—Ç–∫–æ–∏–Ω
–≥–¥–µ –∫—É–ø–∏—Ç—å usdt?
—Ö–æ—á—É –∫—É–ø–∏—Ç—å –∫—Ä–∏–ø—Ç—É
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç—ã
–ö–∞–∂–¥—ã–π –æ—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **—Ä–∞–∑–Ω—ã–º**!

### 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
```bash
# –°–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
fly logs --app vibee-mcp -f | grep TRIGGER_REPLY
```

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã AI

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –ó–∞—á–µ–º |
|----------|----------|-------|
| temperature | 0.9 | –í—ã—Å–æ–∫–æ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ |
| max_tokens | 150 | –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è 1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π |
| model | grok-4.1-fast | –ë—ã—Å—Ç—Ä—ã–π –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π |

## –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–±–ª–µ–º–∞: –í—Å—ë –µ—â—ë –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –æ—Ç–≤–µ—Ç—ã

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
```bash
# 1. API key —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω?
fly logs --app vibee-mcp | grep "No API key"

# 2. AI –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è?
fly logs --app vibee-mcp | grep "Calling AI"

# 3. –ö–∞–∫–æ–π —Å—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞?
fly logs --app vibee-mcp | grep "Response status"
```

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ï—Å–ª–∏ –Ω–µ—Ç API key
fly secrets set OPENROUTER_API_KEY=sk-or-v1-xxx --app vibee-mcp

# –ï—Å–ª–∏ 401 Unauthorized
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–ª—é—á –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

# –ï—Å–ª–∏ 429 Rate Limit
# –ü–æ–¥–æ–∂–¥–∏—Ç–µ –∏–ª–∏ —É–≤–µ–ª–∏—á—å—Ç–µ –ª–∏–º–∏—Ç
```

### –ü—Ä–æ–±–ª–µ–º–∞: AI –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä–∏—Ç—å:**
```bash
fly logs --app vibee-mcp | grep "TRIGGER_REPLY"
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ "No API key":**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã
fly secrets list --app vibee-mcp

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–ª—é—á
fly secrets set OPENROUTER_API_KEY=REDACTED_OPENROUTER_KEY --app vibee-mcp

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
fly apps restart vibee-mcp
```

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

1. `gleam/src/vibee/telegram/telegram_agent.gleam`
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ temperature: 0.9
   - –£–ª—É—á—à–µ–Ω –ø—Ä–æ–º–ø—Ç —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## Deploy

```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
cd /workspaces/vibee-gleam
./deploy.sh

# –ò–ª–∏ —á–µ—Ä–µ–∑ GitHub
git add .
git commit -m "Fix: Add AI variety for trigger responses"
git push origin main
```

---

**Status**: Fixed
**Last Updated**: 2025-12-18 05:10 UTC
