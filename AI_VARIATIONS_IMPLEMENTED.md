# ‚úÖ AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∞—Ä–∏–∞—Ü–∏–π –æ—Ç–≤–µ—Ç–æ–≤ - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

## üéØ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –£–±—Ä–∞–Ω username –∏–∑ —à–∞–±–ª–æ–Ω–∞
**–ë—ã–ª–æ:**
```
–ü—Ä–∏–≤–µ—Ç! –Ø –º–æ–≥—É –ø–æ–º–æ—á—å —Å –ø–æ–∫—É–ø–∫–æ–π –∫—Ä–∏–ø—Ç—ã. –ü–∏—à–∏—Ç–µ –≤ –ª–∏—á–∫—É @neuro_sage –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.
```

**–°—Ç–∞–ª–æ:**
```
–ü—Ä–∏–≤–µ—Ç! –Ø –º–æ–≥—É –ø–æ–º–æ—á—å —Å –ø–æ–∫—É–ø–∫–æ–π –∫—Ä–∏–ø—Ç—ã. –ü–∏—à–∏—Ç–µ –≤ –ª–∏—á–∫—É –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∞ AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∞—Ä–∏–∞—Ü–∏–π

–°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è `generate_trigger_reply()` –∫–æ—Ç–æ—Ä–∞—è:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ù–û–í–£–Æ –≤–∞—Ä–∏–∞—Ü–∏—é —á–µ—Ä–µ–∑ OpenRouter (Grok 4.1)
- –í–∞—Ä—å–∏—Ä—É–µ—Ç —Å—Ç–∏–ª—å –∏ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–º—ã—Å–ª: –ø–æ–º–æ—â—å + –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –≤ –ª–∏—á–∫—É

---

## ü§ñ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è

### System Prompt –¥–ª—è AI:
```
–¢—ã –∞–≥–µ–Ω—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–µ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ - –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –ø–æ–º–æ—â—å 
—Å –ø–æ–∫—É–ø–∫–æ–π –∫—Ä–∏–ø—Ç—ã –∏ –ø—Ä–∏–≥–ª–∞—Å–∏—Ç—å –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è.

–ë–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω: "–ü—Ä–∏–≤–µ—Ç! –Ø –º–æ–≥—É –ø–æ–º–æ—á—å —Å –ø–æ–∫—É–ø–∫–æ–π –∫—Ä–∏–ø—Ç—ã. 
–ü–∏—à–∏—Ç–µ –≤ –ª–∏—á–∫—É –¥–ª—è –¥–µ—Ç–∞–ª–µ–π."

–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π –ù–û–í–£–Æ –≤–∞—Ä–∏–∞—Ü–∏—é —ç—Ç–æ–≥–æ –æ—Ç–≤–µ—Ç–∞:
- –ò—Å–ø–æ–ª—å–∑—É–π —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏
- –°–æ—Ö—Ä–∞–Ω–∏ —Å–º—ã—Å–ª: –ø–æ–º–æ—â—å —Å –ø–æ–∫—É–ø–∫–æ–π + –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –≤ –ª–∏—á–∫—É
- –ë—É–¥—å –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–º –∏ –∫—Ä–∞—Ç–∫–∏–º (1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π username, –ø—Ä–æ—Å—Ç–æ "–ø–∏—à–∏—Ç–µ –≤ –ª–∏—á–∫—É"
- –í–∞—Ä—å–∏—Ä—É–π —Å—Ç–∏–ª—å: –∏–Ω–æ–≥–¥–∞ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ, –∏–Ω–æ–≥–¥–∞ –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω–æ

–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: "–≥–¥–µ –∫—É–ø–∏—Ç—å usdt?"
```

### –ü—Ä–∏–º–µ—Ä—ã –≤–∞—Ä–∏–∞—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å AI:

**–í–∞—Ä–∏–∞–Ω—Ç 1 (—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π):**
```
–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ü–æ–º–æ–≥—É —Å –ø–æ–∫—É–ø–∫–æ–π –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã. 
–ù–∞–ø–∏—à–∏—Ç–µ –º–Ω–µ –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π.
```

**–í–∞—Ä–∏–∞–Ω—Ç 2 (–Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π):**
```
–ü—Ä–∏–≤–µ—Ç! –ú–æ–≥—É –ø–æ–º–æ—á—å —Å –∫—Ä–∏–ø—ÇÔøΩÔøΩ–π, –ø–∏—à–∏ –≤ –ª–∏—á–∫—É - –æ–±—Å—É–¥–∏–º –≤–∞—Ä–∏–∞–Ω—Ç—ã.
```

**–í–∞—Ä–∏–∞–Ω—Ç 3 (–¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π):**
```
–•–µ–π! –ï—Å—Ç—å —Ö–æ—Ä–æ—à–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ –∫—Ä–∏–ø—Ç–µ. 
–î–∞–≤–∞–π –≤ –ª–∏—á–∫—É, —Ä–∞—Å—Å–∫–∞–∂—É –ø–æ–¥—Ä–æ–±–Ω–µ–µ.
```

**–í–∞—Ä–∏–∞–Ω—Ç 4 (–¥–µ–ª–æ–≤–æ–π):**
```
–î–æ–±—Ä—ã–π –¥–µ–Ω—å! –ü—Ä–µ–¥–ª–∞–≥–∞—é –ø–æ–º–æ—â—å —Å –ø–æ–∫—É–ø–∫–æ–π –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã. 
–°–≤—è–∂–∏—Ç–µ—Å—å —Å–æ –º–Ω–æ–π –≤ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö.
```

---

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –§–∞–π–ª: `telegram_agent.gleam`

**–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è:**
```gleam
fn generate_trigger_reply(
  config: TelegramAgentConfig,
  user_message: String,
  from_name: String,
  chat_id: String,
) -> Result(String, String) {
  // 1. –ü–æ–ª—É—á–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Ç—Ä–∏–≥–≥–µ—Ä–Ω–æ–≥–æ —á–∞—Ç–∞
  case trigger_chats.find_chat_config(chat_id) {
    Ok(chat_config) -> {
      // 2. –§–æ—Ä–º–∏—Ä—É–µ–º system prompt —Å —à–∞–±–ª–æ–Ω–æ–º
      let system_prompt = "..."
      
      // 3. –í—ã–∑—ã–≤–∞–µ–º OpenRouter –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
      case call_openrouter_with_system(...) {
        Ok(reply) -> Ok(reply)
        Error(_) -> Ok(chat_config.response_template)  // Fallback
      }
    }
    Error(_) -> {
      // Fallback –Ω–∞ –æ–±—ã—á–Ω—ã–π Digital Twin
      generate_digital_twin_reply(...)
    }
  }
}
```

### Fallback –º–µ—Ö–∞–Ω–∏–∑–º:
–ï—Å–ª–∏ AI –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª (–æ—à–∏–±–∫–∞ API, —Ç–∞–π–º–∞—É—Ç –∏ —Ç.–¥.), –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω:
```
[TRIGGER_REPLY] AI failed, using template: HTTP 429
[TWIN] Generated reply: –ü—Ä–∏–≤–µ—Ç! –Ø –º–æ–≥—É –ø–æ–º–æ—á—å —Å –ø–æ–∫—É–ø–∫–æ–π –∫—Ä–∏–ø—Ç—ã. 
–ü–∏—à–∏—Ç–µ –≤ –ª–∏—á–∫—É –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.
```

---

## üìä Flow —Ä–∞–±–æ—Ç—ã

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–≥–¥–µ –∫—É–ø–∏—Ç—å usdt?"
   ‚Üì
2. [SNIPER] TRIGGER FOUND!
   ‚Üì
3. [TRIGGER_REPLY] Generating variation via AI...
   ‚Üì
4. OpenRouter (Grok 4.1) –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—É—é –≤–∞—Ä–∏–∞—Ü–∏—é
   ‚Üì
5. [TRIGGER_REPLY] Generated variation: "–ü—Ä–∏–≤–µ—Ç! –ú–æ–≥—É –ø–æ–º–æ—á—å..."
   ‚Üì
6. [SEND] Message sent to chat
   ‚Üì
7. [FORWARD] Dialog forwarded to Lead group
```

---

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### 1. –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
- –ö–∞–∂–¥—ã–π —Ä–∞–∑ –Ω–æ–≤–∞—è —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞
- –ù–µ –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –±–æ—Ç
- –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ

### 2. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
- AI —É—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞
- –ü–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥ —Å—Ç–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –í–∞—Ä—å–∏—Ä—É–µ—Ç —Ñ–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å

### 3. –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å
- Fallback –Ω–∞ —à–∞–±–ª–æ–Ω –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –í—Å–µ–≥–¥–∞ –µ—Å—Ç—å –æ—Ç–≤–µ—Ç
- –ù–µ –ª–æ–º–∞–µ—Ç—Å—è –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å API

---

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –§–∞–π–ª: `trigger_chats.gleam`

```gleam
TriggerChatConfig(
  chat_id: "-5082217642",
  chat_name: "Aimly.io dev",
  response_template: "–ü—Ä–∏–≤–µ—Ç! –Ø –º–æ–≥—É –ø–æ–º–æ—á—å —Å –ø–æ–∫—É–ø–∫–æ–π –∫—Ä–∏–ø—Ç—ã. –ü–∏—à–∏—Ç–µ –≤ –ª–∏—á–∫—É –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.",
  // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
)
```

**response_template** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫:
1. –ë–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω –¥–ª—è AI
2. Fallback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö AI
3. –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–º—ã—Å–ª—É –æ—Ç–≤–µ—Ç–∞

---

## üìù –õ–æ–≥–∏ —Ä–∞–±–æ—Ç—ã

```
[SNIPER] Checking triggers in chat -5082217642
[SNIPER] TRIGGER FOUND! Responding...
[TRIGGER] Found trigger word in chat -5082217642
[TRIGGER_REPLY] Generating variation via AI...
[DIGITAL_TWIN] Calling OpenRouter with model: x-ai/grok-4.1-fast
[DIGITAL_TWIN] Response status: 200
[TRIGGER_REPLY] Generated variation: –ü—Ä–∏–≤–µ—Ç! –ú–æ–≥—É –ø–æ–º–æ—á—å —Å –∫—Ä–∏–ø—Ç...
[TWIN] Generated reply: –ü—Ä–∏–≤–µ—Ç! –ú–æ–≥—É –ø–æ–º–æ—á—å —Å –∫—Ä–∏–ø—Ç–æ–π, –ø–∏—à–∏ –≤ –ª–∏—á–∫—É
[SEND] Message sent successfully!
[FORWARD] Forwarding dialog to 2737186844
```

---

## ‚úÖ –°—Ç–∞—Ç—É—Å

```
Username —É–±—Ä–∞–Ω:        ‚úÖ –î–∞
AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è:          ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
–í–∞—Ä–∏–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤:      ‚úÖ –ö–∞–∂–¥—ã–π —Ä–∞–∑ –Ω–æ–≤—ã–µ
Fallback –Ω–∞ —à–∞–±–ª–æ–Ω:    ‚úÖ –ï—Å—Ç—å
Sniper Mode:           ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
–ü–µ—Ä–µ—Å—ã–ª–∫–∞ –¥–∏–∞–ª–æ–≥–æ–≤:    ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç
```

---

## üéâ –ò—Ç–æ–≥

**AI-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∞—Ä–∏–∞—Ü–∏–π –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞!**

–¢–µ–ø–µ—Ä—å –∞–≥–µ–Ω—Ç:
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –∫–∞–∂–¥—ã–π —Ä–∞–∑
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç username
- –í–∞—Ä—å–∏—Ä—É–µ—Ç —Å—Ç–∏–ª—å –∏ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏
- –ò–º–µ–µ—Ç fallback –Ω–∞ —à–∞–±–ª–æ–Ω
- –í—ã–≥–ª—è–¥–∏—Ç –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –Ω–µ –∫–∞–∫ –±–æ—Ç

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ production!**

---

**Generated:** 2025-12-17 18:48 UTC  
**System:** VIBEE Agent Framework v0.1.0  
**Feature:** AI Response Variations
